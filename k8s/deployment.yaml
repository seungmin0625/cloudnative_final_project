# ArgoCD가 감시할 백엔드 서비스의 Kubernetes 배포 매니페스트
apiVersion: apps/v1
kind: Deployment
metadata:
  name: cloudnative-backend-deployment
  labels:
    app: cloudnative-backend
spec:
  replicas: 2
  selector:
    matchLabels:
      app: cloudnative-backend
  template:
    metadata:
      labels:
        app: cloudnative-backend
    spec:
      containers:
        - name: backend-app
          # 주의: 아래 이미지 태그는 CI/CD 파이프라인에 의해 자동으로 업데이트됩니다.
          # 처음에는 placeholder-tag로 설정해 둡니다.
          image: sngminkim/cloudnative-backend:placeholder-tag
          ports:
            - containerPort: 8080
          # 환경 변수 및 리소스 설정은 필요에 따라 추가
---
apiVersion: v1
kind: Service
metadata:
  name: cloudnative-backend-service
spec:
  selector:
    app: cloudnative-backend
  ports:
    - protocol: TCP
      port: 80
      targetPort: 8080 # 컨테이너의 8080 포트로 연결
  type: LoadBalancer # 또는 NodePort, ClusterIP (환경에 맞게 선택)